# ログインできない場合の対処法

## ✅ 確認済み

- 開発サーバーは起動中（ポート3000, 3001）
- データベースにサンプル店舗が存在
- ログインAPIは正常に動作（PowerShellからテスト済み）

## 🔍 トラブルシューティング手順

### ステップ1: ブラウザのコンソールを確認

1. **ブラウザでログインページを開く**
   - http://localhost:3000/admin/login

2. **開発者ツールを開く**
   - `F12` キーを押す
   - または右クリック → 「検証」を選択

3. **コンソールタブを確認**
   - エラーメッセージがないか確認
   - 赤いエラーメッセージがあれば、その内容をメモしてください

4. **ネットワークタブを確認**
   - 「ネットワーク」タブを開く
   - ログインボタンをクリック
   - `/api/auth/admin/login` というリクエストを探す
   - ステータスコードを確認（200なら成功、400/401/500ならエラー）

### ステップ2: ログイン情報を確認

以下の情報が正しいか確認してください：

- **店舗ID**: `sample-store-001`（正確に入力）
- **パスワード**: `password123`（正確に入力）
- スペースや余分な文字が入っていないか確認

### ステップ3: ブラウザのキャッシュをクリア

1. **Ctrl + Shift + Delete** を押す
2. 「キャッシュされた画像とファイル」にチェック
3. 「データを消去」をクリック
4. ページを再読み込み（F5）

### ステップ4: 別のブラウザで試す

- Chrome、Edge、Firefoxなど、別のブラウザで試してください

### ステップ5: 開発サーバーを再起動

```powershell
# 現在のサーバーを停止（Ctrl + C）
# 再度起動
npm run dev
```

## 🐛 よくあるエラーと対処法

### エラー: "Network Error" または "Failed to fetch"

**原因**: バックエンドサーバーに接続できない

**対処法**:
1. バックエンドサーバーが起動しているか確認
   ```powershell
   curl http://localhost:3001/health
   ```
2. `frontend/.env.local`の`NEXT_PUBLIC_API_URL`が正しいか確認

### エラー: "CORS policy" エラー

**原因**: CORS設定の問題

**対処法**:
- バックエンドのCORS設定を確認（既に設定済みのはず）

### エラー: "店舗IDまたはパスワードが正しくありません"

**原因**: パスワードが間違っている、またはデータベースの問題

**対処法**:
1. パスワードを再確認: `password123`
2. データベースを確認:
   ```powershell
   $psqlPath = "C:\Program Files\PostgreSQL\18\bin\psql.exe"
   $env:PGPASSWORD = "postgres"
   & $psqlPath -U postgres -d pic_cul -c "SELECT store_id FROM stores;"
   ```

### エラー: ページが表示されない

**原因**: フロントエンドサーバーが起動していない

**対処法**:
1. 開発サーバーが起動しているか確認
2. ポート3000が使用可能か確認

## 🔧 手動でログインをテスト

PowerShellで以下を実行して、APIが正常に動作するか確認：

```powershell
$loginData = @{
    store_id = "sample-store-001"
    password = "password123"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:3001/api/auth/admin/login" -Method Post -Body $loginData -ContentType "application/json"
```

成功すれば、トークンが返ってきます。

## 📞 詳細なエラー情報が必要な場合

ブラウザのコンソールに表示されるエラーメッセージを教えてください。それに基づいて、より具体的な対処法を提案できます。











