# ログインエラーの確認方法

## 🔍 Vercelのログを確認する方法

### 方法1: Vercelダッシュボードから確認

1. Vercelダッシュボードにログイン
2. プロジェクトを選択
3. 「Deployments」タブを開く
4. 最新のデプロイをクリック
5. 「Logs」タブを開く（Functionsタブではなく、Logsタブ）
6. ログインを試みる
7. ログを確認

### 方法2: リアルタイムログを確認

1. Vercelダッシュボードにログイン
2. プロジェクトを選択
3. 「Logs」タブを開く（左側のメニュー）
4. ログインを試みる
5. リアルタイムでログを確認

### 方法3: ブラウザのコンソールで確認（最も簡単）

1. ブラウザの開発者ツールを開く（F12）
2. 「Console」タブを開く
3. ログインを試みる
4. エラーメッセージを確認

**確認すべき情報**:
- `Login error:` の後に表示されるエラー
- `Error response:` の後に表示される詳細情報

### 方法4: ネットワークタブで確認

1. ブラウザの開発者ツールを開く（F12）
2. 「Network」タブを開く
3. ログインを試みる
4. `/api/auth/system-admin/login` のリクエストをクリック
5. 「Response」タブでエラーメッセージを確認

**確認すべき情報**:
- ステータスコード（401, 404, 500など）
- レスポンスボディの内容
- `error` フィールド
- `details` フィールド（あれば）

## 🛠️ パスワードをリセットする方法

### ステップ1: SupabaseのSQL Editorを開く

1. Supabaseダッシュボードにログイン
2. プロジェクトを選択
3. 「SQL Editor」を開く（左側のメニュー）

### ステップ2: パスワードをリセット

以下をコピー＆ペーストして実行：

```sql
UPDATE system_admins 
SET password_hash = '$2a$10$TfL2YgEWStCa.70GOP75Se2cAq24kzyP6vMBgycEnxgDs/D8cx8l.',
    updated_at = NOW()
WHERE username = 'admin';

-- 確認
SELECT username, name, LEFT(password_hash, 30) || '...' AS hash_preview
FROM system_admins 
WHERE username = 'admin';
```

### ステップ3: ログインを再試行

- URL: `/system-admin/login`
- ユーザー名: `admin`
- パスワード: `admin123`

## 🔍 デバッグ情報の確認

### ブラウザのコンソールで確認できる情報

ログインを試みると、以下のようなログが表示されるはずです：

```
Login error: [エラーオブジェクト]
Error response: {
  "error": "エラーメッセージ",
  "details": "詳細情報"
}
```

### ネットワークタブで確認できる情報

1. `/api/auth/system-admin/login` のリクエストをクリック
2. 「Headers」タブでリクエストヘッダーを確認
3. 「Payload」タブで送信されたデータを確認
4. 「Response」タブでレスポンスを確認

**レスポンスの例**:
```json
{
  "error": "パスワードが正しくありません",
  "details": "パスワードを確認してください。デフォルトのパスワードは \"admin123\" です。パスワードハッシュが正しくない可能性があります。Supabase SQL Editorで RESET_ADMIN_PASSWORD.sql を実行してください。"
}
```

## ✅ 確認チェックリスト

- [ ] Supabaseでシステム管理者が存在するか確認
- [ ] パスワードハッシュをリセット
- [ ] ブラウザのコンソールでエラーメッセージを確認
- [ ] ネットワークタブでレスポンスを確認
- [ ] ログインを再試行

## 🆘 それでも解決しない場合

以下の情報を収集してください：

1. **ブラウザのコンソールエラー**
   - 完全なエラーメッセージ
   - `Error response:` の内容

2. **ネットワークタブのレスポンス**
   - ステータスコード
   - レスポンスボディの内容

3. **データベースの確認**
   - システム管理者が存在するか
   - パスワードハッシュが正しいか

これらの情報を元に、さらに詳しく調査できます。

