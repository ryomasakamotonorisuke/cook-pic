# PostgreSQLパスワード確認とセットアップ

## 現在の状況

PostgreSQLサービスは起動していますが、パスワードが一致しません。

## 解決方法

### 方法1: パスワードを確認して設定

PostgreSQLインストール時に設定したパスワードを思い出してください。

パスワードがわかったら、`.env`ファイルを編集：

```powershell
cd C:\Users\ngf005148\Desktop\webapps\Pic_cul\backend
notepad .env
```

`DATABASE_URL`の行を以下のように修正：

```env
DATABASE_URL=postgresql://postgres:あなたのパスワード@localhost:5432/pic_cul
```

### 方法2: PostgreSQLのパスワードをリセット

パスワードを忘れた場合、以下の手順でリセットできます：

1. **PostgreSQLの設定ファイルを編集**
   - `C:\Program Files\PostgreSQL\18\data\pg_hba.conf` を開く
   - 以下の行を探す：
     ```
     host    all             all             127.0.0.1/32            scram-sha-256
     ```
   - これを以下に変更：
     ```
     host    all             all             127.0.0.1/32            trust
     ```

2. **PostgreSQLサービスを再起動**
   ```powershell
   Restart-Service -Name "postgresql-x64-18"
   ```

3. **パスワードを設定**
   ```powershell
   $psqlPath = "C:\Program Files\PostgreSQL\18\bin\psql.exe"
   & $psqlPath -U postgres -c "ALTER USER postgres WITH PASSWORD 'postgres';"
   ```

4. **設定ファイルを元に戻す**
   - `pg_hba.conf`を元の設定に戻す
   - サービスを再起動

### 方法3: 簡単な方法 - パスワードを`postgres`に設定

以下のコマンドでパスワードを`postgres`に設定できます（サービスを一時停止する必要があります）：

```powershell
# サービスを停止
Stop-Service -Name "postgresql-x64-18"

# pg_hba.confを編集（管理者権限でメモ帳を開く）
notepad "C:\Program Files\PostgreSQL\18\data\pg_hba.conf"
# すべての`scram-sha-256`を`trust`に変更して保存

# サービスを起動
Start-Service -Name "postgresql-x64-18"

# パスワードを設定
$psqlPath = "C:\Program Files\PostgreSQL\18\bin\psql.exe"
& $psqlPath -U postgres -c "ALTER USER postgres WITH PASSWORD 'postgres';"

# pg_hba.confを元に戻す
notepad "C:\Program Files\PostgreSQL\18\data\pg_hba.conf"
# `trust`を`scram-sha-256`に戻して保存

# サービスを再起動
Restart-Service -Name "postgresql-x64-18"
```

## パスワード設定後の手順

1. **データベースを作成**
   ```powershell
   $psqlPath = "C:\Program Files\PostgreSQL\18\bin\psql.exe"
   $env:PGPASSWORD = "postgres"  # または設定したパスワード
   & $psqlPath -U postgres -c "CREATE DATABASE pic_cul;"
   ```

2. **マイグレーション実行**
   ```powershell
   cd C:\Users\ngf005148\Desktop\webapps\Pic_cul\backend
   npm run db:migrate
   npm run db:seed
   ```

3. **開発サーバー起動**
   ```powershell
   cd ..
   npm run dev
   ```







